library(tidyverse)

#loading the data
urls = c('https://datasets.imdbws.com/title.basics.tsv.gz', 'https://datasets.imdbws.com/title.ratings.tsv.gz')
datasets <- lapply(urls, read_delim, delim='\t', na = '\\N')
basics <- datasets[[1]]
ratings = datasets[[2]]


length(which(is.na(basics$runtimeMinutes)))

#getting rid of the NAs for runtimeMinutes
temp <- basics %>% filter(!is.na(basics$runtimeMinutes))
mean(temp$runtimeMinutes)

#Filtering to only get the movies
temp1 <- temp %>% filter(temp$titleType == "movie")
mean(temp1$runtimeMinutes)
head(temp1)

#Merging the ratings and basics
movies <- merge(temp1, ratings)
head(movies)


#Getting rid of the outliers
movies <- movies %>% filter(movies$runtimeMinutes <=600)
